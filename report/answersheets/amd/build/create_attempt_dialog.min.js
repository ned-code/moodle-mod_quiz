define ("quiz_answersheets/create_attempt_dialog",["jquery","core/modal_factory","core/modal_events","core/ajax","core/notification"],function(a,b,c,d,e){var f={SELECTOR:".create-attempt-btn",init:function init(){a(f.SELECTOR).click(function(d){d.preventDefault();var e=a(this).closest("table").find("button");f.disableButton(e,!0);var g=a(this).data("message"),h=M.util.get_string("create_attempt_modal_button","quiz_answersheets"),i={quizid:a(this).data("quiz-id"),userid:a(this).data("user-id"),url:a(this).data("url")};b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("create_attempt_modal_title","quiz_answersheets"),body:g}).done(function(a){a.setSaveButtonText(h);a.getRoot().on(c.save,i,f.createAttempt);a.show();a.getRoot().on(c.hidden,a,f.closeModal);return a}).catch(function(a){f.exceptionHandler(a,e)})})},closeModal:function closeModal(b){var c=b.data,d=a(f.SELECTOR).closest("table").find("button");c.destroy();f.disableButton(d,!1)},createAttempt:function createAttempt(b){b.preventDefault();var c=b.data,e=a(b.target).find("button");f.disableButton(e,!0);var g=d.call([{methodname:"quiz_answersheets_create_attempt",args:{quizid:c.quizid,userid:c.userid}}]);g[0].then(function(a){var b=a.id||"";window.location.href=f.updateQueryStringParameter(c.url,"lastchanged",b);return!0}).fail(function(a){f.exceptionHandler(a,e)})},disableButton:function disableButton(a,b){a.prop("disabled",b)},exceptionHandler:function exceptionHandler(a,b){e.exception(a);f.disableButton(b,!1)},updateQueryStringParameter:function updateQueryStringParameter(a,b,c){var d=new RegExp("([?&])"+b+"=.*?(&|$)","i"),e=-1!==a.indexOf("?")?"&":"?";if(a.match(d)){return a.replace(d,"$1"+b+"="+c+"$2")}else{return a+e+b+"="+c}}};return f});
//# sourceMappingURL=create_attempt_dialog.min.js.map
